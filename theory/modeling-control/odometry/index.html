
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://ros-mobile-robots.com/theory/modeling-control/odometry/" rel="canonical"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-8.5.10" name="generator"/>
<title>Odometry - DiffBot Differential Drive Mobile Robot</title>
<link href="../../../assets/stylesheets/main.975780f9.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.2505c338.min.css" rel="stylesheet"/>
<script src="../../../js/jquery-3.5.1.min.js"></script>
<script src="../../../js/jquery.fitvids.js"></script>
<!-- Arithmatex -->
<!-- MathJax
        <script src="../../../js/mathjax.js"></script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        -->
<!-- KaTeX -->
<script src="../../../js/katex.js"></script>
<script crossorigin="anonymous" integrity="sha256-F/Xda58SPdcUCr+xhSGz9MA2zQBPb0ASEYKohl8UCHc=" src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js">
</script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/>
<!-- Pseudocode -->
<link href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script>
<script>
        pseudocode.renderElement(document.getElementById("markov-localization"));
    </script>
<!-- UML diagrams using Mermaid -->
<script src="https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js"></script>
<script>
        mermaid.initialize({ startOnLoad: true, securityLevel: "loose" });
    </script>
<!-- Adsense -->
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2214309606626131"></script>
<!-- Cookie consent -->
<link href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" rel="stylesheet" type="text/css">
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-5Z9V7GPRX3"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-5Z9V7GPRX3",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-5Z9V7GPRX3",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
</link><link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="indigo" data-md-color-primary="white" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#odometry">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="DiffBot Differential Drive Mobile Robot" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="DiffBot Differential Drive Mobile Robot">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            DiffBot Differential Drive Mobile Robot
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Odometry
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/ros-mobile-robots/diffbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
      Home
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../technical_requirements/">
        Getting Started
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../hardware_setup/overview/">
        Hardware Setup
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../processing_units/">
        Processing Units
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../packages/">
        ROS Software Packages
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../../">
        Robotics Theory
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../motion-and-odometry/">
        Hardware and Theory
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../insiders/">
      Insiders
    </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="DiffBot Differential Drive Mobile Robot" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="DiffBot Differential Drive Mobile Robot">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    DiffBot Differential Drive Mobile Robot
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/ros-mobile-robots/diffbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
        Home
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Getting Started" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../technical_requirements/">
        Technical Requirements
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../components/">
        Components
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
          Hardware Setup
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Hardware Setup" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Hardware Setup
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../hardware_setup/overview/">
        Hardware Setup Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../hardware_setup/3D_print/">
        3D Printing
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../hardware_setup/electronics/">
        Electronics
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../hardware_setup/assembly/">
        Assembly
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../hardware_setup/install/">
        Install
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../processing_units/">Processing Units</a>
<label for="__nav_4">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Processing Units" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Processing Units
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2">
          Single Board Computer
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Single Board Computer" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
          Single Board Computer
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../processing_units/rpi-setup/">
        Raspberry Pi Setup
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../processing_units/jetson-nano-setup/">
        Jetson Nano Setup
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../processing_units/git-setup/">
        Git Setup
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../processing_units/ros-setup/">
        ROS Setup
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../processing_units/teensy-mcu/">
        Microcontroller
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../processing_units/hardware-interfaces/">
        Hardware Interfaces
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../processing_units/ros-network-setup/">
        ROS Network Setup
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../packages/">ROS Software Packages</a>
<label for="__nav_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="ROS Software Packages" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          ROS Software Packages
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../packages/packages-setup/">
        Packages Setup
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diffbot_robot/">
        Robot Package
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4" id="__nav_5_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_4">
          Robot Description
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Robot Description" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_4">
<span class="md-nav__icon md-icon"></span>
          Robot Description
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../robot-description/">
        Robot Description
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../packages/remo_description/">
        Remo Description
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diffbot_gazebo/">
        Simulation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diffbot_control/">
        Control
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_7" id="__nav_5_7" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../packages/diffbot_base/">Base Hardware Interface</a>
<label for="__nav_5_7">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Base Hardware Interface" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_7">
<span class="md-nav__icon md-icon"></span>
          Base Hardware Interface
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../packages/diffbot_base/pid/">
        PID Controllers
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../packages/diffbot_base/low-level/">
        Low-Level PID Approach
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../packages/diffbot_base/high-level/">
        High-Level PID Approach
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diffbot_msgs/">
        Messages
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../grove_motor_driver/">
        Motor Driver
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../DG01D-E-motor-with-encoder/">
        Motor and Encoder
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diffbot_navigation/">
        Navigation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diffbot_slam/">
        SLAM
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diffbot_mbf/">
        Move Base Flex
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diffbot_bringup/">
        Hardware Bringup
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../packages/raspicam_node/">
        Rasperry Pi Camera
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_16" id="__nav_5_16" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_16">
          Inertial Measurement Unit
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Inertial Measurement Unit" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_16">
<span class="md-nav__icon md-icon"></span>
          Inertial Measurement Unit
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../packages/imu/robot_localization/">
        Robot Localization
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../packages/imu/driver-bno055/">
        BNO055 Driver
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../">Robotics Theory</a>
<label for="__nav_6">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Robotics Theory" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          Robotics Theory
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_2" id="__nav_6_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_2">
          Preliminaries
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Preliminaries" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_2">
<span class="md-nav__icon md-icon"></span>
          Preliminaries
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../preliminaries/linear-algebra/">
        Linear Algebra
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../preliminaries/probability/">
        Probability
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../preliminaries/programming/">
        Programming
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" id="__nav_6_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3">
          Modeling and Control
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Modeling and Control" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_3">
<span class="md-nav__icon md-icon"></span>
          Modeling and Control
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../control-systems-introduction/">
        Introduction to Control Systems
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../robot-representations/">
        Representations and models
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../modeling-differential-drive-robot/">
        Modeling a Differential Drive Robot
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Odometry
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Odometry
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#wheel-encoders">
    Wheel Encoders
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#summary-of-odometry-equations">
    Summary of Odometry Equations
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenges-in-odometry">
    Challenges in Odometry
  </a>
<nav aria-label="Challenges in Odometry" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#dead-reconing">
    "Dead reconing"
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kinematic-model">
    Kinematic Model
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#wheel-slip">
    Wheel Slip
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#odometry-calibration">
    Odometry Calibration
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#summary">
    Summary
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_4" id="__nav_6_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_4">
          Robot Vision
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Robot Vision" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_4">
<span class="md-nav__icon md-icon"></span>
          Robot Vision
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../robot-vision/pinhole-camera-model/">
        Pinhole Camera Model
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../robot-vision/camera-calibration/">
        Camera Calibration
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../robot-vision/image-processing/">
        Image Processing
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../robot-vision/features-and-segmentation/">
        Features and Segmentation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../robot-vision/tracking-image-features/">
        Tracking Image Features
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../robot-vision/combining-camera-and-lidar/">
        Combining Camera and Lidar
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../object-detection/overview.md">
        Object Detection
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_6" id="__nav_6_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_6">
          State Estimation
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="State Estimation" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_6">
<span class="md-nav__icon md-icon"></span>
          State Estimation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../state-estimation/recursive-state-estimation/">
        Recursive State Estimation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../state-estimation/gaussian-filters.md">
        Gaussian Filters (Kalman Filter)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../state-estimation/nonparametric-filters/">
        Nonparametric Filters (Particle Filter)
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_7" id="__nav_6_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_7">
          Localization
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Localization" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_7">
<span class="md-nav__icon md-icon"></span>
          Localization
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../localization/markov-and-gaussian-localization/">
        Markov and Gaussian Localization
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../localization/grid-and-monte-carlo-localization.md">
        Grid and Monte Carlo Localization
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_8" id="__nav_6_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_8">
          Mapping
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Mapping" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_8">
<span class="md-nav__icon md-icon"></span>
          Mapping
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../mapping/occupancy-grid-mapping.md">
        Occupancy Grid Mapping
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_9" id="__nav_6_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_9">
          Simultaneous Localization and Mapping (SLAM)
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Simultaneous Localization and Mapping (SLAM)" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_9">
<span class="md-nav__icon md-icon"></span>
          Simultaneous Localization and Mapping (SLAM)
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../slam/slam-overview/">
        SLAM Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../slam/1.%20Robot%20Moving%20and%20Sensing/">
        Robot Class
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../slam/2.%20Omega%20and%20Xi%2C%20Constraints/">
        Omega and Xi Constraints Notebook
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../slam/3.%20Landmark%20Detection%20and%20Tracking/">
        Project 3:  Implement SLAM
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../slam/ekf-slam.md">
        EKF SLAM
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../slam/graphslam.md">
        GraphSLAM
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../slam/fastslam.md">
        FastSLAM
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../slam/gmapping.md">
        GMapping
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../planning1/overview.md">
        Planning I
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../planning2/overview.md">
        Planning II
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../reinforcement-learning/overview.md">
        Learning by Reinforcement
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../imitation-learning/overview.md">
        Learning by Imitation
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7">
          Hardware and Theory
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Hardware and Theory" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
          Hardware and Theory
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../motion-and-odometry/">
        Motion and Odometry
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../power-supply/">
        Power Supply
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../laser-range-scanner/">
        Laser Range Scanner
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../insiders/">
        Insiders
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#wheel-encoders">
    Wheel Encoders
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#summary-of-odometry-equations">
    Summary of Odometry Equations
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenges-in-odometry">
    Challenges in Odometry
  </a>
<nav aria-label="Challenges in Odometry" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#dead-reconing">
    "Dead reconing"
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kinematic-model">
    Kinematic Model
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#wheel-slip">
    Wheel Slip
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#odometry-calibration">
    Odometry Calibration
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#summary">
    Summary
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/ros-mobile-robots/ros-mobile-robots.github.io/tree/main/docs/theory/modeling-control/odometry.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"></path></svg>
</a>
<h1 id="odometry">Odometry</h1>
<p>As robots move in the world to reach an objective or avoid an obstacle,
it is important for them to know where they are.</p>
<p>Through odometry, robots can update their pose in time, as long
as they know where they started from.</p>
<p>Odometry comes from the Greek words ὁδός [odos] (route)
and μέτρον [metron] (measurement), which literally mean: "measurement of the route".</p>
<p>The odometry problem can be formulated as: 
given an initial pose <span class="arithmatex">\(q\)</span> of <span class="arithmatex">\(t_0\)</span> at some initial time,
find the pose at any future time <span class="arithmatex">\(t_0 + \Delta t\)</span>.</p>
<p>Given:</p>
<p><span class="arithmatex">\(q(t_0) = q_{t_0} = q_0 = \begin{bmatrix}x_0 &amp; y_0 &amp; \theta_0 \end{bmatrix}^T\)</span></p>
<p>Find:</p>
<p><span class="arithmatex">\(q_{t_0 + \Delta t}, \forall \Delta t &gt; 0\)</span></p>
<p>When <span class="arithmatex">\(\Delta t\)</span> is small enough to consider the angular speed of the wheels constant, 
the pose update can be approximated as a simple sum.</p>
<p><span class="arithmatex">\(q_{t} = \begin{bmatrix}x_t &amp; y_t &amp; \theta_t \end{bmatrix}^T\)</span></p>
<p><span class="arithmatex">\(q_{t_{k+1}} = q_{t_k} + \dot{q}_{t_k}(t_{k+1} - t_k)\)</span></p>
<p>The process can then be applied iteratively to find the pose at any time, 
and at each iteration using the previous estimate as an initial condition.</p>
<div class="admonition todo">
<p class="admonition-title">TODO</p>
<p>Add odometry update image in world frame</p>
</div>
<p>The essence of odometry is to use the measurements of the distance traveled
by each wheel in a certain time interval and use them to derive the linear and 
the angular displacement of the robot in time through a motion model.</p>
<div class="admonition todo">
<p class="admonition-title">TODO</p>
<p>Add odometry update image with <span class="arithmatex">\(\Delta x\)</span> and <span class="arithmatex">\(\Delta y\)</span> displacements</p>
</div>
<p>For example, if our robot starts at time 0 with pose (0, 0, 0), 
and drives straight for 1 second at the speed of 1 meter per second, 
the odometery will tell us that the final pose will be (1 meter, 0, 0).</p>
<p>Recall, the kinematics model, that maps the wheel velocities to the variation of the pose in time.</p>
<div class="arithmatex">\[
q_{t_{k+1}} \approx q_{t_k} + {\color{orange}{\dot{q}_{t_k}}}(t_{k+1} - t_k)
\]</div>
<p>Kinematic model</p>
<div class="arithmatex">\[
{\color{orange}{\dot{q}_{t}}} = \begin{bmatrix}\dot{x}_t \\ \dot{y}_t \\ \dot{\theta}_t \end{bmatrix} = 
\frac{ \color{green}{R} }{2} \begin{bmatrix}cos(\theta_t) &amp; 0 \\ sin(\theta_t) &amp; 0 \\ 0 &amp; 1\end{bmatrix}
\begin{bmatrix}1 &amp; 1 \\ \frac{1}{ \color{green}{L} } &amp; -\frac{1}{ \color{green}{L} } \end{bmatrix}
\begin{bmatrix} \color{red}{\dot{\phi}_{r,t}} \\ \color{red}{\dot{\phi}_{l,t}} \end{bmatrix}
\]</div>
<p>This model allows us to perform the pose update once we determine its parameters,
which are the wheel radii, which we assume identical, and the distance between the wheels, or the baseline.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><span class="arithmatex">\({\color{green}{R}}\)</span>: wheel radius</li>
<li><span class="arithmatex">\(2 {\color{green}{L}}\)</span>: baseline (distance between wheels)</li>
</ul>
<p>What's also needed is to measure the wheel angular velocities.</p>
<p><strong>Measurements</strong></p>
<ul>
<li><span class="arithmatex">\(\color{red}{\dot{\phi}_{l,t}}\)</span>: wheel angular speeds</li>
</ul>
<h2 id="wheel-encoders">Wheel Encoders</h2>
<p>To measure the wheel angular velocities, we can use wheel encoders.
Although there are various implementations, the operation principle of wheel encoders is simple.</p>
<p>The outer rim of the motor's rotor has some evenly spaced, fixed markers.
Optical encoders, for example, have a perforated disk where the empty space are the markers.</p>
<div class="admonition todo">
<p class="admonition-title">TODO</p>
<p>Add encoder wheel image robotc.net</p>
</div>
<ul>
<li>One pulse every <span class="arithmatex">\({\color{red}{\alpha}} = \frac{2\pi}{N_{tot}}\)</span> radians</li>
</ul>
<p>Every time any of these markers transitions through some reference position on the stator, 
the marker is sensed, and a signal is produced.</p>
<p>For example, in optical encoders, a light sensor will pick up the light from a source 
every time an empty space in the disk comes about.</p>
<p>Knowing how many markers there are in a whole circumference, 
we can derive how much each wheel rotated by just counting the pulses in each of the k-th time interval.</p>
<ul>
<li>Wheel rotation (in <span class="arithmatex">\(\Delta t_k\)</span>): <span class="arithmatex">\({\color{orange}{\Delta \phi_k}} = N_k \cdot {\color{red}{\alpha}}\)</span></li>
</ul>
<p>By dividing the total rotation by delta t, we can then measure the average wheel angular speed in that time frame.</p>
<ul>
<li>Angular speed: <span class="arithmatex">\(\dot{\phi}_{t_k} \approx \frac{ {\color{orange}{\Delta \phi_k}} }{\Delta t_k}\)</span></li>
</ul>
<p>Expanding the kinematics model expressions, we gain insight on the pose update process.</p>
<div class="arithmatex">\[
\begin{align}
&amp;&amp;{\color{orange}{\dot{q}_{t}}} &amp;= \begin{bmatrix}\dot{x}_t \\ \dot{y}_t \\ \dot{\theta}_t \end{bmatrix} = 
\frac{ \color{green}{R} }{2} \begin{bmatrix}cos(\theta_t) &amp; 0 \\ sin(\theta_t) &amp; 0 \\ 0 &amp; 1\end{bmatrix}
\begin{bmatrix}1 &amp; 1 \\ \frac{1}{ \color{green}{L} } &amp; -\frac{1}{ \color{green}{L} } \end{bmatrix}
\begin{bmatrix} \color{red}{\dot{\phi}_{r,t}} \\ \color{red}{\dot{\phi}_{l,t}} \end{bmatrix}
{\color{red}{\longleftarrow}}
{\color{red}{\dot{\phi}_{t_k}}} \approx \frac{ \Delta \phi_k }{\Delta t_k} \\
&amp;&amp;{\color{orange}{\downarrow}} \\
&amp;&amp; {\color{green}{q_{t_{k+1}}}} \approx q_{t_k} + &amp;{\color{orange}{\dot{q}_{t_k}}}(t_{k+1} - t_k) \\
&amp;&amp;{\color{green}{\downarrow}} \\
&amp;&amp;{\color{green}{x_{t_{k+1}}}} \approx x_{t_k} + &amp; \frac{R}{2 \cancel{\Delta t_k}} \left(\Delta \phi_{r,t} + \Delta \phi_{l,t} \right) \cos(\theta_{t_k}) \cancel{\Delta t_k} \\
&amp;&amp;{\color{green}{y_{t_{k+1}}}} \approx y_{t_k} + &amp; \frac{R}{2} \left(\Delta \phi_{r,t} + \Delta \phi_{l,t} \right) \sin(\theta_{t_k}) \\
&amp;&amp;{\color{green}{\theta_{t_{k+1}}}} \approx \theta_{t_k} + &amp; \frac{R}{2L} \left(\Delta \phi_{r,t} - \Delta \phi_{l,t} \right) \\
\end{align}
\]</div>
<p>Notice how the time intervals cancel out, so we don't need to actually compute the angular speed of each wheel, 
but just the total rotation.</p>
<p>The <strong>first step</strong> in solving the odometry is transforming the wheel rotations into traveled distances for each wheel.
We count the pulses from the encoders, derive the rotation of each wheel, 
and then multiply by the radius of each wheel.</p>
<div class="arithmatex">\[
\begin{align}
x_{t_{k+1}} &amp;\approx x_{t_k} + \frac{ {\color{orange}{R}} }{2} \left({\color{orange}{\Delta\phi_{r,t}}} + {\color{orange}{\Delta\phi_{l,t}}} \right) \cos(\theta_{t_k}) \\
y_{t_{k+1}} &amp;\approx y_{t_k} + \frac{ {\color{orange}{R}} }{2} \left({\color{orange}{\Delta\phi_{r,t}}} + {\color{orange}{\Delta\phi_{l,t}}} \right) \sin(\theta_{t_k}) \\
\theta_{t_{k+1}} &amp;\approx \theta_{t_k} + \frac{ {\color{orange}{R}} }{2L} \left({\color{orange}{\Delta\phi_{r,t}}} - {\color{orange}{\Delta\phi_{l,t}}} \right) \\
\end{align}
\]</div>
<p>Wheel travelled distance: <span class="arithmatex">\(\color{orange}{d_{l/r}} = R \cdot \Delta \phi_{r/l}\)</span></p>
<div class="admonition todo">
<p class="admonition-title">TODO</p>
<p>Add robot image with <span class="arithmatex">\(d_l\)</span> <span class="arithmatex">\(d_r\)</span> travelled distance</p>
</div>
<p>The <strong>second step</strong> is to transform the wheel displacements into the linear and the angular displacements of the robot reference frame, 
as we have seen in the <a href="../modeling-differential-drive-robot/">modeling section</a>.</p>
<div class="arithmatex">\[
\begin{align}
x_{t_{k+1}} &amp;\approx x_{t_k} + {\color{orange}{ \frac{ d_{r,t_k} + d_{l,t_k} }{2} }} \cos(\theta_{t_k}) \\
y_{t_{k+1}} &amp;\approx y_{t_k} + {\color{orange}{ \frac{ d_{r,t_k} + d_{l,t_k} }{2} }} \sin(\theta_{t_k}) \\
\theta_{t_{k+1}} &amp;\approx \theta_{t_k} + {\color{red}{ \frac{ d_{r,t_k} - d_{l,t_k} }{2L} }} \\
\end{align}
\]</div>
<div class="admonition todo">
<p class="admonition-title">TODO</p>
<p>Add robot image with <span class="arithmatex">\(d_l\)</span> <span class="arithmatex">\(d_r\)</span> travelled distance and <span class="arithmatex">\(\Delta \theta\)</span></p>
</div>
<p>The <strong>final step</strong> is to represent the displacement in the world frame
and add the increments to the previous estimates.</p>
<div class="arithmatex">\[
\begin{align}
x_{t_{k+1}} &amp;\approx x_{t_k} + {\color{orange}{ d_{A,t_k} \cos(\theta_{t_k}) }} \\
y_{t_{k+1}} &amp;\approx y_{t_k} + {\color{orange}{ d_{A,t_k} \sin(\theta_{t_k}) }} \\
\theta_{t_{k+1}} &amp;\approx \theta_{t_k} + \Delta \theta_{t_k} \\
\end{align}
\]</div>
<div class="admonition todo">
<p class="admonition-title">TODO</p>
<p>Add robot image showing increment update in world frame</p>
</div>
<h2 id="summary-of-odometry-equations">Summary of Odometry Equations</h2>
<div class="arithmatex">\[
\begin{align}
x_{t_{k+1}} &amp;\approx x_{t_k} + d_{A,t_k} \cos(\theta_{t_k}) \\
y_{t_{k+1}} &amp;\approx y_{t_k} + d_{A,t_k} \sin(\theta_{t_k}) \\
\theta_{t_{k+1}} &amp;\approx \theta_{t_k} + \Delta \theta_{t_k} \\
\end{align}
\]</div>
<div class="arithmatex">\[
\begin{align}
d_{A,t_k} &amp;= \frac{ d_{r,t_k} + d_{l,t_k} }{2} \\
\Delta \theta_{t_k} &amp;= \frac{ d_{r,t_k} - d_{l,t_k} }{2L} \\
d_{r/l,t_k} &amp;= 2\pi R \frac{N_k}{N_{tot}}
\end{align}
\]</div>
<h2 id="challenges-in-odometry">Challenges in Odometry</h2>
<p>There are practical challenges in odometry.</p>
<h3 id="dead-reconing">"Dead reconing"</h3>
<p>The first practical challenge stems from using this dead reckoning approach, 
which is the official name of always adding an increment to a previous estimate in order to obtain a new one.</p>
<div class="arithmatex">\[
\begin{align}
x_{t_{k+1}} &amp;\approx x_{t_k} + \Delta x_{t_k} \\
y_{t_{k+1}} &amp;\approx y_{t_k} +  \Delta y_{t_k} \\
\theta_{t_{k+1}} &amp;\approx \theta_{t_k} + \Delta \theta_{t_k} \\
\end{align}
\]</div>
<div class="admonition todo">
<p class="admonition-title">TODO</p>
<p>Reuse odometry update image in world frame</p>
</div>
<p>While it might work well for short distances,
over time, errors like the discrete time approximation will accumulate, 
making the estimate drift from reality.</p>
<h3 id="kinematic-model">Kinematic Model</h3>
<p>Second, we're using a mathematical model, that of the kinematics of a differential drive robot,
to translate the actual measurements to the pose of the robot.</p>
<div class="arithmatex">\[
\dot{q}_{t} = 
\frac{R}{2} \begin{bmatrix}cos(\theta_t) &amp; 0 \\ sin(\theta_t) &amp; 0 \\ 0 &amp; 1\end{bmatrix}
\begin{bmatrix}1 &amp; 1 \\ \frac{1}{L} &amp; -\frac{1}{L} \end{bmatrix}
\begin{bmatrix}\dot{\phi}_{r,t} \\ \dot{\phi}_{l,t} \end{bmatrix}
\]</div>
<p>You might recall that we previously said that all models are wrong, although some are useful.
This wisdom is ever more true when the assumptions of the model are not respected.</p>
<h3 id="wheel-slip">Wheel Slip</h3>
<p>In particular, we impose the condition of no slippage of the wheels.</p>
<div class="admonition todo">
<p class="admonition-title">TODO</p>
<p>Add wheel slip images/animation</p>
</div>
<p>When the wheels slip, it means that the motor will be spinning,
the encoders will be producing measurements, but the robot will not be moving the same distance as we are assuming.
This will induce errors in the odometry, and they will compound over time.</p>
<h3 id="odometry-calibration">Odometry Calibration</h3>
<p>Finally, we need to use some actual numerical values for the parameters of the model:
the wheel radii - which, by the way, are assumed to be identical,
but will they really be - and the robot baseline.</p>
<div class="arithmatex">\[
\begin{align}
\Delta \theta_{t_k} &amp;= \frac{ d_{r,t_k} - d_{l,t_k} }{2 {\color{red}{L}} } \\
d_{r/l,t_k} &amp;= 2\pi {\color{red}{R}} \frac{N_k}{N_{tot}}
\end{align}
\]</div>
<p>Accurately measuring these parameters is very important.
Even small imperfections will induce systematic errors in the odometry that, again, will compound over time.</p>
<p>Note that although nominally identical, no two real-world physical robots
will ever be the same due to manufacturing, assembly, or handling
differences.</p>
<p>To find the values of the parameters of the model that best fit our robot,
we will need to perform an odometry calibration procedure.</p>
<h2 id="summary">Summary</h2>
<ul>
<li>
<p>Wheel encoders can be used to update the robot's pose in time:</p>
<ol>
<li>Measure the motor's angular displacements <span class="arithmatex">\(\Delta \phi\)</span> in <span class="arithmatex">\(\Delta t\)</span></li>
<li>Use the kinematics mdoel to find the robot's <span class="arithmatex">\(\Delta x\)</span>, <span class="arithmatex">\(\Delta y\)</span>, <span class="arithmatex">\(\Delta \theta\)</span></li>
<li>Update the pose by adding the calculated increments</li>
</ol>
</li>
<li>
<p>Subject to dfit in time due to accumulation of numerical, slipping/skidding and calibration impercision errors.</p>
</li>
</ul>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" hidden="" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            Back to top
          </a>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Modeling a Differential Drive Robot" class="md-footer__link md-footer__link--prev" href="../modeling-differential-drive-robot/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Modeling a Differential Drive Robot
            </div>
</div>
</a>
<a aria-label="Next: Pinhole Camera Model" class="md-footer__link md-footer__link--next" href="../../robot-vision/pinhole-camera-model/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Pinhole Camera Model
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2021 - 2021 Franz Pucher | <a href="https://www.ros-mobile-robots.com/privacy-policy/">Privacy Policy</a> | <a href="https://www.ros-mobile-robots.com/legal-notice/">Legal Notice</a>
</div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "navigation.indexes"], "search": "../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
<script src="https://gumroad.com/js/gumroad.js"></script>
<script>
        $(document).ready(function(){
            // Target your .container, .wrapper, .post, etc.
            $(".md-main").fitVids();
        });
    </script>
<!-- cookie consent -->
<script data-cfasync="false" src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js"></script>
<script>
    window.cookieconsent.initialise({
    "palette": {
        "popup": {
        "background": "#edeff5",
        "text": "#838391"
        },
        "button": {
        "background": "#4b81e8"
        }
    },
    "theme": "classic"
    });
    </script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>